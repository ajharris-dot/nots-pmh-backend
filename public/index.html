<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Positions Hub</title>
  <link rel="stylesheet" href="styles.css"/>
</head>
<body>
  <header class="topbar">
    <h1>Positions Hub</h1>

    <!-- Center logo -->
    <div class="topbar-logo">
      <img src="/logo.png" alt="Logo">
    </div>

    <div class="topbar-actions">
      <div class="filters">
        <button class="tab active" data-filter="all">All</button>
        <button class="tab" data-filter="Open">Open</button>
        <button class="tab" data-filter="Filled">Filled</button>
      </div>

      <button id="loginBtn" class="secondary">Log In</button>
      <button id="logoutBtn" class="secondary" style="display:none">Log Out</button>

      <!-- Admin-only control (shown by app.js when role === 'admin') -->
      <button id="manageUsersBtn" class="secondary" style="display:none">Manage Users</button>

      <div class="view-toggle" role="group" aria-label="View toggle">
        <button id="cardViewBtn" class="secondary active">Cards</button>
        <button id="listViewBtn" class="secondary">List</button>
      </div>


      <button id="refresh" class="secondary">Refresh</button>
      <button id="addJobBtn" class="primary">+ Add Position</button>
    </div>
  </header>

  <main class="content">
    <!-- Search -->
    <div class="toolbar">
      <input id="search" placeholder="Search job # / title / department" />
    </div>

    <!-- Cards -->
    <div id="jobGrid" class="card-grid"></div>
  </main>

  <!-- Add/Edit Position Modal -->
  <div id="jobModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <h2 id="modalTitle">Add Position</h2>
      <form id="jobForm">
        <input type="hidden" id="jobId"/>

        <label>Job Number
          <input type="text" id="jobNumber" required />
        </label>

        <label>Job Title
          <input type="text" id="jobTitle" required />
        </label>

        <label>Department
          <input type="text" id="department" required />
        </label>

        <!-- Renamed from Due Date -> Filled Date -->
        <label>Filled Date
          <input type="date" id="dueDate" />
        </label>

        <label>Employee (view only)
          <input type="text" id="employee" disabled/>
        </label>

        <div class="modal-actions">
          <button type="submit" class="primary">Save</button>
          <button type="button" id="cancelModal" class="secondary">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <h2>Log In</h2>
      <form id="loginForm">
        <label>Email
          <input type="email" id="loginEmail" required />
        </label>
        <label>Password
          <input type="password" id="loginPassword" required />
        </label>
        <div class="modal-actions">
          <button type="submit" class="primary">Log In</button>
          <button type="button" id="cancelLogin" class="secondary">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Assign Employee Modal -->
  <div id="assignModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card">
      <h2>Assign Employee</h2>
      <form id="assignForm">
        <label for="assignEmployeeName">Employee Name
          <input type="text" id="assignEmployeeName" placeholder="Enter employee name" required />
        </label>

        <div class="modal-actions">
          <button type="submit" class="primary">Assign</button>
          <button type="button" id="cancelAssign" class="secondary">Cancel</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Admin: Manage Users Modal -->
  <div id="usersModal" class="modal hidden" aria-hidden="true">
    <div class="modal-card" style="width:min(720px,95vw)">
      <h2>Manage Users</h2>

      <!-- Create / Edit form -->
      <form id="userForm">
        <input type="hidden" id="userId" />

        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:12px;">
          <label>Email
            <input type="email" id="userEmail" required />
          </label>
          <label>Name
            <input type="text" id="userName" />
          </label>
          <label>Role
            <select id="userRole" required>
              <option value="admin">Admin</option>
              <option value="employment">Employment</option>
              <option value="operations">Operations</option>
              <option value="manager">Manager</option>
              <option value="user">User</option>
            </select>
          </label>
          <label>Password
            <input type="password" id="userPassword" placeholder="Set or change password" />
          </label>
        </div>

        <div class="modal-actions">
          <button type="submit" class="primary">Save User</button>
          <button type="button" id="resetUserForm" class="secondary">New</button>
          <button type="button" id="closeUsersModal" class="secondary">Close</button>
        </div>
      </form>

      <!-- Users list -->
      <div style="margin-top:16px;">
        <h3 style="margin:0 0 8px 0;">Existing Users</h3>
        <div id="usersList" style="max-height:300px; overflow:auto; border:1px solid var(--line); border-radius:8px; padding:8px;">
          <!-- populated by app.js -->
        </div>
      </div>
    </div>
  </div>

  <script src="app.js"></script>
</body>
</html>
